import{readBody as h}from"h3";import"./assets/StartServer-9710052a.js";import"solid-js/web";import"solid-js";async function x(o){const e=await h(o);console.log(e);const t=e.event.message,{chatId:u,chatType:c}=e.event.chat,{eventType:g}=e.header,{senderId:f}=e.event.sender,p=c==="group"?u:f,m=c==="group"?c:"user";if(g==="message.receive.instruction"){const{commandId:s}=t;s==591&&await l(JSON.stringify({recvId:p,recvType:m,contentType:"markdown",content:{text:"TCL大厂图床，限制10MB。请勿乱用"}}));return}if(console.log(t.content),t.contentType!=="image")return;const{imageUrl:y,imageName:i}=t.content;w(y,async function(s){const d=new FormData;d.append("file",s,/(\.tmp|\.webp)$/.test(i)?i.replace(/\.(tmp|webp)$/,".png"):i);const r=await(await fetch("https://mall.tcl.com/rest/servicecenter/upload",{method:"POST",body:d})).json();if(console.log(r),r.code!=="0")return;const{fileName:a,filePath:n}=r.data;await l(JSON.stringify({recvId:p,recvType:m,contentType:"markdown",content:{text:`![${a}](${n})`,buttons:[[{text:"URL",actionType:2,value:n},{text:"HTML",actionType:2,value:`<img src="${n}" alt="${a}" title="${a}" />`},{text:"BBCode",actionType:2,value:`[img]${n}[/img]`},{text:"Markdown",actionType:2,value:`![${a}](${n})`},{text:"Markdown with link",actionType:2,value:`[![${a}](${n})](${n})`}]]}}))})}function w(o,e){fetch(o).then(t=>t.blob()).then(t=>{e(t)})}async function l(o){await(await fetch("https://chat-go.jwzhd.com/open-apis/v1/bot/send?token=14168aeeda604a4f9b5424560795089e",{method:"POST",body:o})).json()}export{x as POST};
