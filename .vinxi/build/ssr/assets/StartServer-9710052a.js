import{ssrElement as N,escape as Z,mergeProps as Pt,ssr as M,isServer as k,getRequestEvent as L,createComponent as v,delegateEvents as Et,ssrHydrationKey as W,useAssets as At,NoHydration as xt,HydrationScript as $t,ssrAttribute as kt,Hydration as Lt}from"solid-js/web";import{lazy as Tt,createComponent as tt,getOwner as et,runWithOwner as nt,createMemo as P,createContext as rt,createSignal as O,createRenderEffect as Ct,untrack as H,useContext as Ot,on as ot,startTransition as Ft,resetErrorBoundaries as X,children as Mt,Show as st,createRoot as It,onCleanup as G,Suspense as qt,ErrorBoundary as Bt}from"solid-js";function Dt(t){t.forEach(e=>{if(!e.attrs.href)return;let n=document.head.querySelector(`link[href="${e.attrs.href}"]`);n||(n=document.createElement("link"),n.setAttribute("rel","preload"),n.setAttribute("as","style"),n.setAttribute("href",e.attrs.href),document.head.appendChild(n))})}var Ut=" ";const jt={style:t=>N("style",t.attrs,()=>Z(t.children),!0),link:t=>N("link",t.attrs,void 0,!0),script:t=>t.attrs.src?N("script",Pt(()=>t.attrs,{get id(){return t.key}}),()=>M(Ut),!0):null};function K(t){let{tag:e,attrs:{key:n,...r}={key:void 0},children:o}=t;return jt[e]({attrs:r,key:n,children:o})}function Nt(t,e,n,r="default"){return Tt(async()=>{{const a=(await t.import())[r],i=(await e.inputs?.[t.src].assets()).filter(h=>h.tag==="style"||h.attrs.rel==="stylesheet");return typeof window<"u"&&Dt(i),{default:h=>[...i.map(f=>K(f)),tt(a,h)]}}})}const at=[{type:"page",$component:{src:"src/routes/index.tsx?pick=default&pick=$css",build:()=>import("../index.js"),import:()=>import("../index.js")},path:"/",filePath:"D:/ovo/test/bare/src/routes/index.tsx"},{type:"api",$GET:{src:"src/routes/api/getSubscription.ts?pick=GET",build:()=>import("../getSubscription.js"),import:()=>import("../getSubscription.js")},path:"/api/getSubscription",filePath:"D:/ovo/test/bare/src/routes/api/getSubscription.ts"},{type:"api",$POST:{src:"src/routes/api/upload.ts?pick=POST",build:()=>import("../upload.js"),import:()=>import("../upload.js")},path:"/api/upload",filePath:"D:/ovo/test/bare/src/routes/api/upload.ts"},{type:"api",$POST:{src:"src/routes/api/yunhu.ts?pick=POST",build:()=>import("../yunhu.js"),import:()=>import("../yunhu.js")},path:"/api/yunhu",filePath:"D:/ovo/test/bare/src/routes/api/yunhu.ts"},{type:"page",$component:{src:"src/routes/tuchuang/index.tsx?pick=default&pick=$css",build:()=>import("../index2.js"),import:()=>import("../index2.js")},path:"/tuchuang/",filePath:"D:/ovo/test/bare/src/routes/tuchuang/index.tsx"}],_t=Ht(at.filter(t=>t.type==="page")),Wt=Kt(at.filter(t=>t.type==="api"));function Ce(t,e){const n=t.replace("","").split("/").filter(Boolean);t:for(const r of Wt){const o=r.matchSegments;if(n.length<o.length||!r.wildcard&&n.length>o.length)continue;for(let i=0;i<o.length;i++){const c=o[i];if(c&&n[i]!==c)continue t}const a=r[`$${e}`];if(a==="skip"||a===void 0)return;const s={};for(const{type:i,name:c,index:h}of r.params)i===":"?s[c]=n[h]:s[c]=n.slice(h).join("/");return{handler:a,params:s}}}function Ht(t){function e(n,r,o,a){const s=Object.values(n).find(i=>o.startsWith(i.id+"/"));return s?(e(s.children||(s.children=[]),r,o.slice(s.id.length)),n):(n.push({...r,id:o,path:o.replace(/\/\([^)/]+\)/g,"")}),n)}return t.sort((n,r)=>n.path.length-r.path.length).reduce((n,r)=>e(n,r,r.path,r.path),[])}function Kt(t){return t.flatMap(e=>it(e.path).map(r=>({...e,path:r}))).map(zt).sort((e,n)=>n.score-e.score)}function it(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let n=t.slice(0,e.index),r=t.slice(e.index+e[0].length);const o=[n,n+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(r);)o.push(n+=e[1]),r=r.slice(e[0].length);return it(r).reduce((a,s)=>[...a,...o.map(i=>i+s)],[])}function zt(t){const e=t.path.split("/").filter(Boolean),n=[],r=[];let o=0,a=!1;for(const[s,i]of e.entries())if(i[0]===":"){const c=i.slice(1);o+=3,n.push({type:":",name:c,index:s}),r.push(null)}else i[0]==="*"?(o-=1,n.push({type:"*",name:i.slice(1),index:s}),a=!0):(o+=4,i.match(/^\(.+\)$/)||r.push(i));return{...t,score:o,params:n,matchSegments:r,wildcard:a}}function Gt(){function t(n){return{...n,...n.$$route?n.$$route.require().route:void 0,metadata:{...n.$$route?n.$$route.require().route.metadata:{},filesystem:!0},component:Nt(n.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:n.children?n.children.map(t):void 0}}return _t.map(t)}let Y;const Jt=()=>k?L().routes:Y||(Y=Gt());function ct(){let t=new Set;function e(o){return t.add(o),()=>t.delete(o)}let n=!1;function r(o,a){if(n)return!(n=!1);const s={to:o,options:a,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const i of t)i.listener({...s,from:i.location,retry:c=>{c&&(n=!0),i.navigate(o,{...a,resolve:!1})}});return!s.defaultPrevented}return{subscribe:e,confirm:r}}let z;function J(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),z=window.history.state._depth}k||J();function Vt(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function Xt(t,e){let n=!1;return()=>{const r=z;J();const o=r==null?null:z-r;if(n){n=!1;return}o&&e(o)?(n=!0,window.history.go(-o)):t()}}const Yt=/^(?:[a-z0-9]+:)?\/\//i,Qt=/^\/+|(\/)\/+$/g,ut="http://sr";function F(t,e=!1){const n=t.replace(Qt,"$1");return n?e||/^[?#]/.test(n)?n:"/"+n:""}function D(t,e,n){if(Yt.test(e))return;const r=F(t),o=n&&F(n);let a="";return!o||e.startsWith("/")?a=r:o.toLowerCase().indexOf(r.toLowerCase())!==0?a=r+o:a=o,(a||"/")+F(e,!a)}function Zt(t,e){return F(t).replace(/\/*(\*.*)?$/g,"")+F(e)}function lt(t){const e={};return t.searchParams.forEach((n,r)=>{e[r]=n}),e}function te(t,e,n){const[r,o]=t.split("/*",2),a=r.split("/").filter(Boolean),s=a.length;return i=>{const c=i.split("/").filter(Boolean),h=c.length-s;if(h<0||h>0&&o===void 0&&!e)return null;const f={path:s?"":"/",params:{}},p=y=>n===void 0?void 0:n[y];for(let y=0;y<s;y++){const w=a[y],u=c[y],l=w[0]===":",m=l?w.slice(1):w;if(l&&_(u,p(m)))f.params[m]=u;else if(l||!_(u,w))return null;f.path+=`/${u}`}if(o){const y=h?c.slice(-h).join("/"):"";if(_(y,p(o)))f.params[o]=y;else return null}return f}}function _(t,e){const n=r=>r.localeCompare(t,void 0,{sensitivity:"base"})===0;return e===void 0?!0:typeof e=="string"?n(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(n):e instanceof RegExp?e.test(t):!1}function ee(t){const[e,n]=t.pattern.split("/*",2),r=e.split("/").filter(Boolean);return r.reduce((o,a)=>o+(a.startsWith(":")?2:3),r.length-(n===void 0?0:1))}function ht(t){const e=new Map,n=et();return new Proxy({},{get(r,o){return e.has(o)||nt(n,()=>e.set(o,P(()=>t()[o]))),e.get(o)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function ft(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let n=t.slice(0,e.index),r=t.slice(e.index+e[0].length);const o=[n,n+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(r);)o.push(n+=e[1]),r=r.slice(e[0].length);return ft(r).reduce((a,s)=>[...a,...o.map(i=>i+s)],[])}const ne=100,re=rt(),dt=rt();function oe(t,e=""){const{component:n,load:r,children:o,info:a}=t,s=!o||Array.isArray(o)&&!o.length,i={key:t,component:n,load:r,info:a};return pt(t.path).reduce((c,h)=>{for(const f of ft(h)){const p=Zt(e,f);let y=s?p:p.split("/*",1)[0];y=y.split("/").map(w=>w.startsWith(":")||w.startsWith("*")?w:encodeURIComponent(w)).join("/"),c.push({...i,originalPath:f,pattern:y,matcher:te(y,!s,t.matchFilters)})}return c},[])}function se(t,e=0){return{routes:t,score:ee(t[t.length-1])*1e4-e,matcher(n){const r=[];for(let o=t.length-1;o>=0;o--){const a=t[o],s=a.matcher(n);if(!s)return null;r.unshift({...s,route:a})}return r}}}function pt(t){return Array.isArray(t)?t:[t]}function mt(t,e="",n=[],r=[]){const o=pt(t);for(let a=0,s=o.length;a<s;a++){const i=o[a];if(i&&typeof i=="object"){i.hasOwnProperty("path")||(i.path="");const c=oe(i,e);for(const h of c){n.push(h);const f=Array.isArray(i.children)&&i.children.length===0;if(i.children&&!f)mt(i.children,h.pattern,n,r);else{const p=se([...n],r.length);r.push(p)}n.pop()}}}return n.length?r:r.sort((a,s)=>s.score-a.score)}function U(t,e){for(let n=0,r=t.length;n<r;n++){const o=t[n].matcher(e);if(o)return o}return[]}function ae(t,e){const n=new URL(ut),r=P(c=>{const h=t();try{return new URL(h,n)}catch{return console.error(`Invalid path ${h}`),c}},n,{equals:(c,h)=>c.href===h.href}),o=P(()=>r().pathname),a=P(()=>r().search,!0),s=P(()=>r().hash),i=()=>"";return{get pathname(){return o()},get search(){return a()},get hash(){return s()},get state(){return e()},get key(){return i()},query:ht(ot(a,()=>lt(r())))}}let A;function ie(t,e,n,r={}){const{signal:[o,a],utils:s={}}=t,i=s.parsePath||(d=>d),c=s.renderPath||(d=>d),h=s.beforeLeave||ct(),f=D("",r.base||"");if(f===void 0)throw new Error(`${f} is not a valid base path`);f&&!o().value&&a({value:f,replace:!0,scroll:!1});const[p,y]=O(!1),w=async d=>{y(!0);try{await Ft(d)}finally{y(!1)}},[u,l]=O(o().value),[m,g]=O(o().state),I=ae(u,m),R=[],E=O(k?St():[]),C={pattern:f,params:{},path:()=>f,outlet:()=>null,resolvePath(d){return D(f,d)}};return Ct(()=>{const{value:d,state:b}=o();H(()=>{d!==u()&&w(()=>{A="native",l(d),g(b),X(),E[1]([])}).then(()=>{A=void 0})})}),{base:C,location:I,isRouting:p,renderPath:c,parsePath:i,navigatorFactory:bt,beforeLeave:h,preloadRoute:Rt,singleFlight:r.singleFlight===void 0?!0:r.singleFlight,submissions:E};function wt(d,b,x){H(()=>{if(typeof b=="number"){b&&(s.go?s.go(b):console.warn("Router integration does not support relative routing"));return}const{replace:q,resolve:j,scroll:$,state:T}={replace:!1,resolve:!0,scroll:!0,...x},S=j?d.resolvePath(b):D("",b);if(S===void 0)throw new Error(`Path '${b}' is not a routable path`);if(R.length>=ne)throw new Error("Too many redirects");const V=u();if(S!==V||T!==m()){if(k){const B=L();B&&(B.response={status:302,headers:new Headers({Location:S})}),a({value:S,replace:q,scroll:$,state:T})}else if(h.confirm(S,x)){const B=R.push({value:V,replace:q,scroll:$,state:m()});w(()=>{A="navigate",l(S),g(T),X(),E[1]([])}).then(()=>{R.length===B&&(A=void 0,vt({value:S,state:T}))})}}})}function bt(d){return d=d||Ot(dt)||C,(b,x)=>wt(d,b,x)}function vt(d){const b=R[0];b&&((d.value!==b.value||d.state!==b.state)&&a({...d,replace:b.replace,scroll:b.scroll}),R.length=0)}function Rt(d,b){const x=U(n(),d.pathname),q=A;A="preload";for(let j in x){const{route:$,params:T}=x[j];$.component&&$.component.preload&&$.component.preload();const{load:S}=$;b&&S&&nt(e(),()=>S({params:T,location:{pathname:d.pathname,search:d.search,hash:d.hash,query:lt(d),state:null,key:""},intent:"preload"}))}A=q}function St(){const d=L();return d&&d.router&&d.router.submission?[d.router.submission]:[]}}function ce(t,e,n,r,o){const{base:a,location:s}=t,{pattern:i,component:c,load:h}=r().route,f=P(()=>r().path);c&&c.preload&&c.preload();const p=h?h({params:o,location:s,intent:A||"initial"}):void 0;return{parent:e,pattern:i,path:f,params:o,outlet:()=>c?tt(c,{params:o,location:s,data:p,get children(){return n()}}):n(),resolvePath(w){return D(a.path(),w,f())}}}const gt=t=>e=>{const{base:n}=e,r=Mt(()=>e.children),o=P(()=>mt(r(),e.base||""));let a;const s=ie(t,()=>a,o,{base:n,singleFlight:e.singleFlight}),i=s.location;return t.create&&t.create(s),v(re.Provider,{value:s,get children(){return v(ue,{location:i,get root(){return e.root},get load(){return e.rootLoad},get children(){return[(a=et())&&null,v(le,{routerState:s,get branches(){return o()}})]}})}})};function ue(t){const e=t.location,n=P(()=>t.load&&H(()=>t.load({params:{},location:e,intent:"preload"})));return v(st,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:r=>v(r,{params:{},location:e,get data(){return n()},get children(){return t.children}})})}function le(t){const e=P(()=>U(t.branches,t.routerState.location.pathname));if(k){const s=L();if(s&&s.router&&s.router.dataOnly){he(s,t.routerState,t.branches);return}s&&((s.router||(s.router={})).matches||(s.router.matches=e().map(({route:i,path:c,params:h})=>({path:i.originalPath,pattern:i.pattern,match:c,params:h,info:i.info}))))}const n=ht(()=>{const s=e(),i={};for(let c=0;c<s.length;c++)Object.assign(i,s[c].params);return i}),r=[];let o;const a=P(ot(e,(s,i,c)=>{let h=i&&s.length===i.length;const f=[];for(let p=0,y=s.length;p<y;p++){const w=i&&i[p],u=s[p];c&&w&&u.route.key===w.route.key?f[p]=c[p]:(h=!1,r[p]&&r[p](),It(l=>{r[p]=l,f[p]=ce(t.routerState,f[p-1]||t.routerState.base,Q(()=>a()[p+1]),()=>e()[p],n)}))}return r.splice(s.length).forEach(p=>p()),c&&h?c:(o=f[0],f)}));return Q(()=>a()&&o)()}const Q=t=>()=>v(st,{get when(){return t()},keyed:!0,children:e=>v(dt.Provider,{value:e,get children(){return e.outlet()}})});function he(t,e,n){const r=new URL(t.request.url),o=U(n,new URL(t.router.previousUrl||t.request.url).pathname),a=U(n,r.pathname);for(let s=0;s<a.length;s++){(!o[s]||a[s].route!==o[s].route)&&(t.router.dataOnly=!0);const{route:i,params:c}=a[s];i.load&&i.load({params:c,location:e.location,intent:"preload"})}}function fe([t,e],n,r){return[n?()=>n(t()):t,r?o=>e(r(o)):e]}function de(t){if(t==="#")return null;try{return document.querySelector(t)}catch{return null}}function pe(t){let e=!1;const n=o=>typeof o=="string"?{value:o}:o,r=fe(O(n(t.get()),{equals:(o,a)=>o.value===a.value}),void 0,o=>(!e&&t.set(o),o));return t.init&&G(t.init((o=t.get())=>{e=!0,r[1](n(o)),e=!1})),gt({signal:r,create:t.create,utils:t.utils})}function me(t,e,n){return t.addEventListener(e,n),()=>t.removeEventListener(e,n)}function ge(t,e){const n=de(`#${t}`);n?n.scrollIntoView():e&&window.scrollTo(0,0)}function ye(t){const e=new URL(t);return e.pathname+e.search}function we(t){let e;const n={value:t.url||(e=L())&&ye(e.request.url)||""};return gt({signal:[()=>n,r=>Object.assign(n,r)]})(t)}const be=new Map;function ve(t=!0,e=!1,n="/_server"){return r=>{const o=r.base.path(),a=r.navigatorFactory(r.base);let s={};function i(u){return u.namespaceURI==="http://www.w3.org/2000/svg"}function c(u){if(u.defaultPrevented||u.button!==0||u.metaKey||u.altKey||u.ctrlKey||u.shiftKey)return;const l=u.composedPath().find(C=>C instanceof Node&&C.nodeName.toUpperCase()==="A");if(!l||e&&!l.hasAttribute("link"))return;const m=i(l),g=m?l.href.baseVal:l.href;if((m?l.target.baseVal:l.target)||!g&&!l.hasAttribute("state"))return;const R=(l.getAttribute("rel")||"").split(/\s+/);if(l.hasAttribute("download")||R&&R.includes("external"))return;const E=m?new URL(g,document.baseURI):new URL(g);if(!(E.origin!==window.location.origin||o&&E.pathname&&!E.pathname.toLowerCase().startsWith(o.toLowerCase())))return[l,E]}function h(u){const l=c(u);if(!l)return;const[m,g]=l,I=r.parsePath(g.pathname+g.search+g.hash),R=m.getAttribute("state");u.preventDefault(),a(I,{resolve:!1,replace:m.hasAttribute("replace"),scroll:!m.hasAttribute("noscroll"),state:R&&JSON.parse(R)})}function f(u){const l=c(u);if(!l)return;const[m,g]=l;s[g.pathname]||r.preloadRoute(g,m.getAttribute("preload")!=="false")}function p(u){const l=c(u);if(!l)return;const[m,g]=l;s[g.pathname]||(s[g.pathname]=setTimeout(()=>{r.preloadRoute(g,m.getAttribute("preload")!=="false"),delete s[g.pathname]},200))}function y(u){const l=c(u);if(!l)return;const[,m]=l;s[m.pathname]&&(clearTimeout(s[m.pathname]),delete s[m.pathname])}function w(u){let l=u.submitter&&u.submitter.hasAttribute("formaction")?u.submitter.getAttribute("formaction"):u.target.getAttribute("action");if(!l)return;if(!l.startsWith("https://action/")){const g=new URL(l,ut);if(l=r.parsePath(g.pathname+g.search),!l.startsWith(n))return}if(u.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const m=be.get(l);if(m){u.preventDefault();const g=new FormData(u.target);u.submitter&&u.submitter.name&&g.append(u.submitter.name,u.submitter.value),m.call({r,f:u.target},g)}}Et(["click","submit"]),document.addEventListener("click",h),t&&(document.addEventListener("mouseover",p),document.addEventListener("mouseout",y),document.addEventListener("focusin",f),document.addEventListener("touchstart",f)),document.addEventListener("submit",w),G(()=>{document.removeEventListener("click",h),t&&(document.removeEventListener("mouseover",p),document.removeEventListener("mouseout",y),document.removeEventListener("focusin",f),document.removeEventListener("touchstart",f)),document.removeEventListener("submit",w)})}}function Re(t){if(k)return we(t);const e=()=>({value:window.location.pathname+window.location.search+window.location.hash,state:window.history.state}),n=ct();return pe({get:e,set({value:r,replace:o,scroll:a,state:s}){o?window.history.replaceState(Vt(s),"",r):window.history.pushState(s,"",r),ge(window.location.hash.slice(1),a),J()},init:r=>me(window,"popstate",Xt(r,o=>{if(o&&o<0)return!n.confirm(o);{const a=e();return!n.confirm(a.value,{state:a.state})}})),create:ve(t.preload,t.explicitLinks,t.actionBase),utils:{go:r=>window.history.go(r),beforeLeave:n}})(t)}function Se(t){if(k){const e=L();e&&G(e.components.status(t))}return null}var Pe=["<h1",">Loading...</h1>"];function Ee(){return v(Re,{root:t=>v(qt,{get fallback(){return M(Pe,W())},get children(){return t.children}}),get children(){return v(Jt,{})}})}function Ae(t){return v(Bt,{get fallback(){return v(Se,{code:500})},get children(){return t.children}})}var xe=["<script",">","<\/script>"],$e=["<script",' type="module" async',"><\/script>"];const ke=M("<!DOCTYPE html>");function yt(t,e,n=[]){for(let r=0;r<e.length;r++){const o=e[r];if(o.path!==t[0].path)continue;let a=[...n,o];if(o.children){const s=t.slice(1);if(s.length===0||(a=yt(s,o.children,a),!a))continue}return a}}function Oe(t){const e=L();let n=[];return Promise.resolve().then(async()=>{if(e.routerMatches&&e.routerMatches[0]){const r=[...e.routerMatches[0]];for(;r.length&&(!r[0].metadata||!r[0].metadata.filesystem);)r.shift();const o=r.length&&yt(r,e.routes);if(o)for(let a=0;a<o.length;a++){const s=o[a],c=await globalThis.MANIFEST.client.inputs[s.$component.src].assets();n.push.apply(n,c)}else console.warn("No route matched for preloading js assets")}n=[...new Map(n.map(r=>[r.attrs.key,r])).values()].filter(r=>r.attrs.rel==="modulepreload"&&!e.assets.find(o=>o.attrs.key===r.attrs.key))}),At(()=>n.length?n.map(r=>K(r)):void 0),v(xt,{get children(){return[ke,v(t.document,{get assets(){return[v($t,{}),e.assets.map(r=>K(r))]},get scripts(){return[M(xe,W(),`window.manifest = ${JSON.stringify(e.manifest)}`),M($e,W(),kt("src",Z(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]},get children(){return v(Lt,{get children(){return v(Ae,{get children(){return v(Ee,{})}})}})}})]}})}export{Oe as S,Gt as c,Ce as m};
